{
  "openapi": "3.0.1",
  "info": {
    "title": "Catena-X Portal App Marketplace API",
    "version": "v2"
  },
  "servers": [
    {
      "url":"https://portal-backend.dev.demo.catena-x.net",
      "description": "DEV"
    },
    {
      "url":"https://portal-backend.int.demo.catena-x.net",
      "description": "INT"
    }
  ],
  "security": [
    {
      "centralidp": [
        "openid",
        "profile"
      ]
    }
  ],
  "paths": {
    "/api/Apps/active": {
      "get": {
        "tags": [
          "Apps"
        ],
        "summary": "Retrieves all active apps in the marketplace.",
        "description": "Example: GET: /api/apps/active",
        "parameters": [
          {
            "name": "lang",
            "in": "query",
            "description": "Optional two character language specifier for the app description. Will be empty if not provided.",
            "schema": {
              "type": "string"
            },
            "example": "en"
          }
        ],
        "responses": {
          "200": {
            "description": "Returns the list of all active marketplace apps.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppViewModel"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppViewModel"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppViewModel"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/Apps/{appId}": {
      "get": {
        "tags": [
          "Apps"
        ],
        "summary": "Retrieves app details for an app referenced by id.",
        "description": "Example: GET: /api/apps/D3B1ECA2-6148-4008-9E6C-C1C2AEA5C645",
        "parameters": [
          {
            "name": "appId",
            "in": "path",
            "description": "ID of the app to retrieve.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "D3B1ECA2-6148-4008-9E6C-C1C2AEA5C645"
          },
          {
            "name": "lang",
            "in": "query",
            "description": "Optional two character language specifier for the app description. Will be empty if not provided.",
            "schema": {
              "type": "string"
            },
            "example": "en"
          }
        ],
        "responses": {
          "200": {
            "description": "Returns the requested app details.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/AppDetailsViewModel"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppDetailsViewModel"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppDetailsViewModel"
                }
              }
            }
          },
          "400": {
            "description": "If sub claim is empty/invalid.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              },
              "application/json": {
                "schema": {
                  "type": "string"
                }
              },
              "text/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/api/Apps": {
      "post": {
        "tags": [
          "Apps"
        ],
        "summary": "Creates an app according to input model.",
        "description": "Example: POST: /api/apps",
        "requestBody": {
          "description": "Input model for app creation.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AppInputModel"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/AppInputModel"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/AppInputModel"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Returns created app's ID.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string",
                  "format": "uuid"
                }
              },
              "application/json": {
                "schema": {
                  "type": "string",
                  "format": "uuid"
                }
              },
              "text/json": {
                "schema": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          }
        }
      }
    },
    "/api/Apps/favourites": {
      "get": {
        "tags": [
          "Apps"
        ],
        "summary": "Retrieves IDs of all favourite apps of the current user (by sub claim).",
        "description": "Example: GET: /api/apps/favourites",
        "responses": {
          "200": {
            "description": "Returns the list of favourite apps of current user.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "format": "uuid"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "format": "uuid"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "format": "uuid"
                  }
                }
              }
            }
          },
          "400": {
            "description": "If sub claim is empty/invalid.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              },
              "application/json": {
                "schema": {
                  "type": "string"
                }
              },
              "text/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/api/Apps/{appId}/favourite": {
      "post": {
        "tags": [
          "Apps"
        ],
        "summary": "Adds an app to current user's favourites.",
        "description": "Example: POST: /api/apps/D3B1ECA2-6148-4008-9E6C-C1C2AEA5C645/favourite",
        "parameters": [
          {
            "name": "appId",
            "in": "path",
            "description": "ID of the app to add to user favourites.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "D3B1ECA2-6148-4008-9E6C-C1C2AEA5C645"
          }
        ],
        "responses": {
          "200": {
            "description": "Favourite app was successfully added to user."
          },
          "400": {
            "description": "If sub claim is empty/invalid or user does not exist.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              },
              "application/json": {
                "schema": {
                  "type": "string"
                }
              },
              "text/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Apps"
        ],
        "summary": "Removes an app from current user's favourites.",
        "description": "Example: DELETE: /api/apps/D3B1ECA2-6148-4008-9E6C-C1C2AEA5C645/favourite",
        "parameters": [
          {
            "name": "appId",
            "in": "path",
            "description": "ID of the app to remove from user favourites.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "D3B1ECA2-6148-4008-9E6C-C1C2AEA5C645"
          }
        ],
        "responses": {
          "200": {
            "description": "Favourite app was successfully removed from user."
          },
          "400": {
            "description": "If sub claim is empty/invalid or user does not exist.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              },
              "application/json": {
                "schema": {
                  "type": "string"
                }
              },
              "text/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/api/Apps/{appId}/subscribe": {
      "post": {
        "tags": [
          "Apps"
        ],
        "summary": "Adds an app to current user's company's subscriptions.",
        "description": "Example: POST: /api/apps/D3B1ECA2-6148-4008-9E6C-C1C2AEA5C645/subscribe",
        "parameters": [
          {
            "name": "appId",
            "in": "path",
            "description": "ID of the app to subscribe to.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "D3B1ECA2-6148-4008-9E6C-C1C2AEA5C645"
          }
        ],
        "responses": {
          "200": {
            "description": "Favourite app was successfully subscribed to."
          },
          "400": {
            "description": "If sub claim is empty/invalid or user does not exist.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              },
              "application/json": {
                "schema": {
                  "type": "string"
                }
              },
              "text/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "centralidp": {
        "type": "openIdConnect",
        "openIdConnectUrl": "https://catenaxdev003akssrv.germanywestcentral.cloudapp.azure.com/iamcentralidp/auth/realms/CX-Central/.well-known/openid-configuration"
      }
    },
    "schemas": {
      "AppDetailsViewModel": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "ID of the app.",
            "format": "uuid"
          },
          "title": {
            "type": "string",
            "description": "Title or name of the app.",
            "nullable": true
          },
          "leadPictureUri": {
            "type": "string",
            "description": "Uri to app's lead picture.",
            "nullable": true
          },
          "detailPictureUris": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of URIs to app's secondary pictures.",
            "nullable": true
          },
          "providerUri": {
            "type": "string",
            "description": "Uri to provider's marketing presence.",
            "nullable": true
          },
          "provider": {
            "type": "string",
            "description": "Provider of the app.",
            "nullable": true
          },
          "contactEmail": {
            "type": "string",
            "description": "Email address of the app's primary contact.",
            "nullable": true
          },
          "contactNumber": {
            "type": "string",
            "description": "Phone number of the app's primary contact.",
            "nullable": true
          },
          "useCases": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Names of the app's use cases.",
            "nullable": true
          },
          "longDescription": {
            "type": "string",
            "description": "Long description of the app.",
            "nullable": true
          },
          "price": {
            "type": "string",
            "description": "Pricing information of the app.",
            "nullable": true
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Tags assigned to application.",
            "nullable": true
          },
          "isSubscribed": {
            "type": "boolean",
            "description": "Whether app has been purchased by the user's company.",
            "nullable": true
          }
        },
        "additionalProperties": false,
        "description": "View model of an application's detailed data."
      },
      "AppInputModel": {
        "type": "object",
        "properties": {
          "title": {
            "maxLength": 255,
            "type": "string",
            "description": "Title or name of the app.",
            "nullable": true
          },
          "provider": {
            "maxLength": 255,
            "type": "string",
            "description": "Provider of the app.",
            "nullable": true
          },
          "providerUri": {
            "maxLength": 255,
            "type": "string",
            "description": "Uri to provider's marketing presence.",
            "nullable": true
          },
          "appUri": {
            "maxLength": 255,
            "type": "string",
            "description": "Uri for app access.",
            "nullable": true
          },
          "leadPictureUri": {
            "maxLength": 255,
            "type": "string",
            "description": "Uri to app's lead picture.",
            "nullable": true
          },
          "contactEmail": {
            "maxLength": 255,
            "type": "string",
            "description": "Email address of the app's primary contact.",
            "nullable": true
          },
          "contactNumber": {
            "maxLength": 255,
            "type": "string",
            "description": "Phone number of the app's primary contact.",
            "nullable": true
          },
          "providerCompanyId": {
            "type": "string",
            "description": "ID of the app's providing company.",
            "format": "uuid",
            "nullable": true
          },
          "useCaseIds": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "IDs of app's use cases.",
            "nullable": true
          },
          "descriptions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LocalizedDescription"
            },
            "description": "Descriptions of the app in different languages.",
            "nullable": true
          },
          "supportedLanguageCodes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Two character language codes for the app's supported languages.",
            "nullable": true
          },
          "price": {
            "type": "string",
            "description": "Pricing information of the app.",
            "nullable": true
          }
        },
        "additionalProperties": false,
        "description": "Model for requesting creation of an application."
      },
      "AppViewModel": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "ID of the app.",
            "format": "uuid"
          },
          "title": {
            "type": "string",
            "description": "Title or name of the app.",
            "nullable": true
          },
          "shortDescription": {
            "type": "string",
            "description": "Short description of the app.",
            "nullable": true
          },
          "provider": {
            "type": "string",
            "description": "Provider of the app.",
            "nullable": true
          },
          "useCases": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Names of the app's use cases.",
            "nullable": true
          },
          "price": {
            "type": "string",
            "description": "Pricing information of the app.",
            "nullable": true
          },
          "leadPictureUri": {
            "type": "string",
            "description": "Uri to app's lead picture.",
            "nullable": true
          }
        },
        "additionalProperties": false,
        "description": "View model of an application's base data."
      },
      "LocalizedDescription": {
        "type": "object",
        "properties": {
          "languageCode": {
            "maxLength": 2,
            "minLength": 2,
            "type": "string",
            "description": "Two character language code.",
            "nullable": true
          },
          "longDescription": {
            "maxLength": 4096,
            "type": "string",
            "description": "Long description in specified language.",
            "nullable": true
          },
          "shortDescription": {
            "maxLength": 255,
            "type": "string",
            "description": "Short description in specified language.",
            "nullable": true
          }
        },
        "additionalProperties": false,
        "description": "Simple model to specify descriptions for a language."
      }
    }
  }
}